library(data.table)
fread('height_prediction/sib_betas/input/sib_beta_gwas_p.txt')
getwd()
args<-"temp"
library("optparse")
library(data.table)
library(dplyr)
library(biomaRt)
#**************************************************************************
#read in gwas data and list of 697 SNPs highlighted in the wood paper *****
#**************************************************************************
#args<-c("ALL","F")
fread('../../input/sib_beta_gwas_p.txt')-> ukb_height #read in betas from sibling analyses
ukb_height[,CHR:=as.integer(CHR)]
ukb_height[,POS:=as.integer(POS)]
ukb_height[order(CHR,POS)]-> ukb_height
print('checkpoint 1')
#if skip is true, this will be skipped:
dir<-paste0(getwd(), "/")
parentdir<-gsub("/scripts", "", dir)
dir
parentdir
paste0('mkdir -m 777 ', parentdir, args[1], '/')-> smtg
try(system(smtg))
for(X in 1:22){
        system(paste0('touch ', parentdir, args[1],"/temp_chr", X, ".txt"))
        ukb_height[CHR==X]-> a
        setkey(a, POS)
        unique(a)-> a
        fwrite(as.data.frame(a[, .(CHR,POS)][order(CHR,POS)][,V3:=paste(CHR,POS,sep="\t")][,V3]), file=paste0(parentdir, args[1],"/temp_chr", X, ".txt"), quote=F, col.names=F, row.names=F)
        print(X)
        paste0(parentdir, args[1],"/temp_chr", X, ".txt")-> b
        system(paste0('sort ', b, " |uniq > ", parentdir, args[1], "/tmp"))
        system(paste0('mv ', parentdir, args[1], '/tmp ',b ))
}
system(paste0('bash ', dir, 'master.sh ', dir, args[1]))
dir
paste0('bash ', dir, 'master.sh ', dir, args[1]))
paste0('bash ', dir, 'master.sh ', dir, args[1])
print('checkpoint 1')
#if skip is true, this will be skipped:
home="/home/bbita/"
dir=paste0(home, "height_prediction/sib_betas/JHS/scripts")
parentdir<-gsub("/scripts", "", dir)
paste0('mkdir -m 777 ', parentdir, args[1], '/')-> smtg
try(system(smtg))
for(X in 1:22){
        system(paste0('touch ', parentdir, args[1],"/temp_chr", X, ".txt"))
        ukb_height[CHR==X]-> a
        setkey(a, POS)
        unique(a)-> a
        fwrite(as.data.frame(a[, .(CHR,POS)][order(CHR,POS)][,V3:=paste(CHR,POS,sep="\t")][,V3]), file=paste0(parentdir, args[1],"/temp_chr", X, ".txt"), quote=F, col.names=F, row.names=F)
        print(X)
        paste0(parentdir, args[1],"/temp_chr", X, ".txt")-> b
        system(paste0('sort ', b, " |uniq > ", parentdir, args[1], "/tmp"))
        system(paste0('mv ', parentdir, args[1], '/tmp ',b ))
}
aste0('bash ', dir, 'master.sh ', dir, args[1])
paste0('bash ', dir, 'master.sh ', dir, args[1])
if skip is true, this will be skipped:
home="/home/bbita/"
dir=paste0(home, "height_prediction/sib_betas/JHS/scripts/")
parentdir<-gsub("/scripts", "", dir)
paste0('mkdir -m 777 ', parentdir, args[1], '/')-> smtg
try(system(smtg))
for(X in 1:22){
        system(paste0('touch ', parentdir, args[1],"/temp_chr", X, ".txt"))
        ukb_height[CHR==X]-> a
        setkey(a, POS)
        unique(a)-> a
        fwrite(as.data.frame(a[, .(CHR,POS)][order(CHR,POS)][,V3:=paste(CHR,POS,sep="\t")][,V3]), file=paste0(parentdir, args[1],"/temp_chr", X, ".txt"), quote=F, col.names=F, row.names=F)
        print(X)
        paste0(parentdir, args[1],"/temp_chr", X, ".txt")-> b
        system(paste0('sort ', b, " |uniq > ", parentdir, args[1], "/tmp"))
        system(paste0('mv ', parentdir, args[1], '/tmp ',b ))
}
paste0('bash ', dir, 'master.sh ', dir, args[1])
ststem('master.sh temp')
system('master.sh temp')
system('./master.sh temp')
q
